<form ms-controller="userType" ms-widget="validation">
    <div class="m-form-group">
        <label>所在医院</label>
        <input type="text" class="form-control input-lg" ms-duplex-required="form.hospital" data-duplex-event="change"  name="hospital" placeholder="输入所属医院">
    </div>
    <div class="m-form-group">
        <label>所在地</label>
        <div ms-include-src="app.$tplUrl+'chooseArea.html'" data-include-replace="true"></div>
    </div>
    <div ms-include-src="app.$tplUrl+'chooseKs.html'" data-include-replace="true"></div>
    <button type="submit"  ms-class="u-btn-c4:isLock"  class="u-btn u-btn-lg f-mt15" >{{isLock?'稍等...':'保存';}}</button>
</form>

<script>
    var userType=avalon.define({
        $id:'userType',
        isLock:0,
        form:{hospital:''},
        validation: app.$getValidation(function(form){
            userType.isLock=1;
            $.post(app.$host+'member/info/add',$(form).serialize(),function(data) {
                if(data.error){
                    $.showMsg(data.error,2);
                    userType.isLock=0;
                }else{//输入成功
                    $.showMsg('提交成功！正在跳转...',1);
                    setTimeout(function(){location.href=app.$root+"ucenter.html";},1000);
                }
            });
        })
    });
    userType.$watch("setData", function(form){
        sys.extend(userType.form,form);
    });
</script>