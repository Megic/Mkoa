<form ms-controller="userType" ms-widget="validation">
    <div class="m-form-group">
        <label>个人姓名</label>
        <input type="text" class="form-control input-lg" ms-duplex-required="form.name" data-duplex-event="change" name="name" placeholder="输入您的姓名">
    </div>
    <div class="m-form-group">
        <label>性别</label>
        <select name="sex" ms-duplex="form.sex">
            <option value="1">男</option>
            <option value="2">女</option>
        </select>
    </div>
    <div class="m-form-group">
        <label>所在地</label>
        <div ms-include-src="app.$tplUrl+'chooseArea.html'" data-include-replace="true"></div>
    </div>
    <div class="m-form-group">
        <label>公司/单位</label>
        <input type="text" class="form-control input-lg" ms-duplex-required="form.company" data-duplex-event="change" name="company" placeholder="输入您所在的公司/单位">
    </div>
    <div class="m-form-group">
        <label>职位</label>
        <input type="text" class="form-control input-lg" ms-duplex-required="form.office" data-duplex-event="change"name="office" placeholder="输入您的职位">
    </div>
    <button type="submit"  ms-class="u-btn-c4:isLock"  class="u-btn u-btn-lg f-mt15" >{{isLock?'稍等...':'保存';}}</button>
    <a href="ucenter.html" class="u-btn u-btn-c4 u-btn-lg f-mt15">以后再填</a>
</form>
<script>
    var userType=avalon.define({
        $id:'userType',
        isLock:0,
        form:{name:'',company:'',office:'',sex:1},
        validation: app.$getValidation(function(form){
            userType.isLock=1;
            $.post(app.$host+'member/info/add',$(form).serialize(),function(data) {
                if(data.error){
                    $.showMsg(data.error,2);
                    userType.isLock=0;
                }else{//输入成功
                    $.showMsg('提交成功！正在跳转...',1);
                    setTimeout(function(){location.href=app.$root+"ucenter.html";},1000);
                }
            });
        })
    });
    userType.$watch("setData", function(form){
        sys.extend(userType.form,form);
    });
</script>
